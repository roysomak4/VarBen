flowOrder="TACGTACGTCTGAGCATCGATCGATGTACAGC"
barcode="CTAAGGTAAC"
libKey="TCAG"
sequence = "GGTCTCTCATGGCACTGTACTCTTCTTGTCCAGCTGTATCCAGTATGTCCAACAAACAGGTTTCACCATCTATAACCACTTGTTTTCTGTAGGGGCTGAACCGCACGACTCCATCCTTGTTGGGCAGGCCCAGGCGGTGCAGTGAGTCGGCCCGCAGCAGCAACAGGAAGTCAAAGGCCTGTCAGGAAGAGGATGGTGAAAGCCAGAGCCAAGCTCGTGCAGGCCCAGGACAGGCGGCGTCCCGTCTCGAGTGATGATCCAGTGTTTTCAGCGA"

ori = '208,-2,196,-2,14,208,-12,258,-2,240,208,4,518,460,36,-6,284,-4,16,496,6,232,266,224,232,500,254,-4,262,-4,0,32,228,-4,232,16,252,-4,240,0,26,46,12,0,224,0,16,0,250,54,488,0,0,198,22,240,4,16,0,0,240,-2,0,64,252,-2,20,262,256,244,252,0,272,250,492,0,-2,16,226,-2,542,10,210,6,244,534,0,270,-2,248,18,-2,270,-2,24,44,322,-4,20,218,236,238,28,0,234,478,-4,-2,292,228,20,-4,246,20,-4,206,244,30,262,8,276,22,-6,-10,516,456,-6,232,20,708,254,8,20,202,46,476,674,246,-2,-4,250,0,486,210,284,206,-14,24,222,42,32,264,282,-8,-6,460,462,244,-20,232,502,22,32,178,898,0,206,8,306,28,0,218,14,-8,48,30,232,14,30,242,48,28,880,6,24,8,-22,-12,268,-22,86,30,254,-2,14,282,64,488,480,212,76,236,-28,8,248,-16,230,-26,14,34,220,208,6,256,62,-14,200,-4,-32,-34,594,256,-8,26,214,-22,474,42,470,0,86,226,488,30,-28,676,28,-12,292,210,26,10,472,-26,-2,680,30,226,18,456,-24,-24,336,10,470,92,234,-24,36,272,52,-2,232,28,70,34,8,60,234,182,78,-6,250,-24,292,230,24,100,234,18,202,10,-6,-24,366,26,496,772,6,12,16,230,-10,14,252,20,-22,12,0,20,298,234,254,212,26,-16,238,20,12,242,54,490,6,30,-14,-20,290,304,498,96,24,454,-18,230,182,12,314,0,28,0,0,20,758,484,476,42,214,4,274,12,218,232,80,284,0,466,0,406,84,38,308,10,-22,296,0,460,30,202,46,-2,220,-18,-34,388,120,56,96,14,188,-8,228,600,40,32,256,66,-26,52,-24,-12,466,210,258,46,34,274,38,268,4,-18,414,24,10,40,-14,6,474,258,312,8,202,182,296,104,232,42,210,26,4,68,4,0,352,236,486,646,40,234,16,440,54,210,318,38,20,38,-6,-12,268,398,294,-10,42,20,482,6,52,232,214,-14,150,32,-12,18,688,0,282,100,242,8,170,90,270,10,276,178,42,84,6,-10,302,202,80,-14,240,-20,280,204,254,94,254,212,240,28,-14,4,506,174,128,-8,242,48,22,250,756,18,284,2,50,64,-10,30,256,194,244,22,52,2,254,182'

origFlowSignal = [ int(x) for x in ori.split(",")]
from varben.common.methods import reCalculateFlowSignal
signal, seq = reCalculateFlowSignal(sequence, origFlowSignal, flowOrder, libKey, barcode)
print(origFlowSignal, "!!", len(origFlowSignal))
print(signal, len(signal))
print(sequence, len(sequence))
print(seq, len(seq))
